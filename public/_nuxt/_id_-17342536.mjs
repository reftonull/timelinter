import{_ as w,o as i,s as g,k as r,c as a,d as s,x as c,e as y,T,p as C,h as S,y as D,V as M,a as p,m,b as h,z as V,j as _,F as f,r as k,A as z,B as b,t as $}from"./entry-ec39a906.mjs";import{v as P}from"./v4-5ff0568a.mjs";const N={props:{show:Boolean},setup(e,{expose:t}){t();const d={props:e};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}},A=e=>(C("data-v-10c93707"),e=e(),S(),e),F={key:0,class:"modal-mask"},O={class:"modal-wrapper"},R={class:"modal-container"},j={class:"modal-header"},K=A(()=>s("h2",null,"default header",-1)),L={class:"modal-body"},q=D("default body"),G={class:"modal-footer"};function H(e,t,n,d,E,l){return i(),g(T,{name:"modal"},{default:r(()=>[n.show?(i(),a("div",F,[s("div",O,[s("div",R,[s("div",j,[c(e.$slots,"header",{},()=>[K],!0)]),s("div",L,[c(e.$slots,"body",{},()=>[q],!0)]),s("div",G,[c(e.$slots,"footer",{},()=>[s("div",{class:"fancyBtn",onClick:t[0]||(t[0]=v=>e.$emit("close"))}," OK ")],!0)])])])])):y("",!0)]),_:3})}var I=w(N,[["render",H],["__scopeId","data-v-10c93707"]]);const J={components:{VueCal:M,PeopleModal:I},data:()=>({events:[],selected:"People",timeline:{},people:[],showModal:!1,peopleStore:{},selectedItem:null,selectedPerson:null}),async mounted(){const e=p(),t=m();await e.getTimelines(),this.peopleStore=h(),this.peopleStore.getPeople(),this.timeline=e.getTimeline(t.params.id),await this.refreshPeople(),this.initEvents(),console.log("timeline is",this.timeline)},blocks:[],backgroundEvents:[],methods:{async save(){const e=m();await p().updateBlocks(e.params.id,this.$options.blocks),console.log("saved")},initEvents(){this.$options.blocks=this.timeline.blocks.map(e=>{const t=this.peopleStore.people.find(n=>n._id===e.person);return{id:P(),title:t.name,person:t._id,start:new Date(e.startTime),end:new Date(e.endTime)}}),this.events=this.$options.blocks},onEventCreate(e,t){return this.selectedPerson?(e.id=P(),e.title=this.selectedPerson.name,e.person=this.selectedPerson._id,this.$options.blocks.push(e),e):!1},selectPerson(e){this.selectedPerson=e,this.$options.backgroundEvents=e.availability.map(t=>({start:new Date(t.startTime),end:new Date(t.endTime),background:!0,class:"lunch",deletable:!1,resizable:!1})),this.events=[...this.$options.backgroundEvents,...this.$options.blocks],console.log(this.events),console.log(this.$options.backgroundEvents)},async refreshPeople(){const e=h();this.people=await Promise.all(this.timeline.people.map(t=>{const n=e.getPersonById(t);return console.log(n),n})),console.log("people are",this.people)},selectItem(e){this.selectedItem=this.peopleStore.people[e],console.log(this.selectedItem)},updateEvent(e){const t=this.$options.blocks.findIndex(n=>n.id===e.event.id);console.log(t),t!==-1&&(this.$options.blocks[t]=e.event)},add(){this.events=this.$options.blocks.slice()},async addPerson(e){const t=p(),n=m();await t.addPerson(e,n.params.id),await t.getTimelines(),this.timeline=t.getTimeline(n.params.id),await this.refreshPeople(),this.selectedItem=null,this.showModal=!1},delEvent(){}}},Q=e=>(C("data-v-5e5f55c6"),e=e(),S(),e),U={class:"container"},W={class:"flex"},X={class:"sidebar"},Y={class:"segmented"},Z={key:0,class:"sidebarContainer"},x=["onClick"],ee=Q(()=>s("h2",null,"Select Person",-1)),te=["onClick"],se={class:"btnRow"};function oe(e,t,n,d,E,l){const v=V("vue-cal"),B=I;return i(),a("div",U,[s("div",W,[_(v,{class:"vuecal--blue-theme cal",time:!0,"disable-views":["years","year","month","day"],"hide-view-selector":"","hide-title-bar":"","editable-events":{title:!1,drag:!0,resize:!0,delete:!0,create:!0},events:e.events,"snap-to-time":15,"time-from":6*60,"time-to":23*60,"time-step":30,"selected-date":"2022-04-26",onEventDrop:l.updateEvent,onEventDurationChange:l.updateEvent,"on-event-create":l.onEventCreate},null,8,["events","onEventDrop","onEventDurationChange","on-event-create"]),s("div",X,[s("div",Y,[s("div",{onClick:t[0]||(t[0]=o=>e.selected="People")},"People"),s("div",{onClick:t[1]||(t[1]=o=>e.selected="Problems")},"Problems")]),e.selected==="People"?(i(),a("div",Z,[(i(!0),a(f,null,k(e.people,o=>(i(),a("div",{key:o.name},[s("div",{class:b(["listItem",{selected:e.selectedPerson&&o.name===e.selectedPerson.name}]),onClick:u=>l.selectPerson(o)},$(o.name),11,x)]))),128)),s("div",{onClick:t[2]||(t[2]=o=>e.showModal=!0),class:"fancyBtn"}," Add Person "),(i(),g(z,{to:"body"},[_(B,{show:e.showModal,onClose:t[5]||(t[5]=o=>e.showModal=!1)},{header:r(()=>[ee]),body:r(()=>[(i(!0),a(f,null,k(e.peopleStore.people,(o,u)=>(i(),a("div",{key:o._id},[s("div",{class:b([{selected:e.selectedItem&&o.name===e.selectedItem.name},"listItem"]),onClick:ne=>l.selectItem(u)},$(o.name),11,te)]))),128))]),footer:r(()=>[s("div",{class:"fancyBtn",onClick:t[3]||(t[3]=o=>l.addPerson(e.selectedItem._id))}," Add "),s("div",{class:"normalBtn",onClick:t[4]||(t[4]=o=>e.showModal=!1)}," Cancel ")]),_:1},8,["show"])]))])):y("",!0)])]),s("div",se,[s("div",{onClick:t[6]||(t[6]=(...o)=>l.save&&l.save(...o)),class:"fancyBtn saveBtn"},"Save")])])}var ae=w(J,[["render",oe],["__scopeId","data-v-5e5f55c6"]]);export{ae as default};
